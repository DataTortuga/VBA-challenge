Sub stock()

Dim WS_Count As Long
Dim i As Long
Dim lRow As Long
Dim j As Long
Dim Ychange As Long
Dim rstart As Long
Dim rEnd As Long
Dim Count As Long
Dim Temp As Double
Dim OpenP As Double
Dim CloseP As Double
Dim Vol As Double
Dim str1 As String
Dim str2 As String


WS_Count = ActiveWorkbook.Worksheets.Count
Count = 0
    For i = 1 To WS_Count
        
        ActiveWorkbook.Worksheets(i).Range("H1").Value = "Ticker"
        ActiveWorkbook.Worksheets(i).Range("I1").Value = "Yearly Change"
        ActiveWorkbook.Worksheets(i).Range("J1").Value = "Percent Change"
        ActiveWorkbook.Worksheets(i).Range("K1").Value = "Volume"
        
        lRow = ActiveWorkbook.Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row
        rstart = 2
        Count = 0
        For j = 2 To lRow

            If ActiveWorkbook.Worksheets(i).Cells(j + 1, 1) <> ActiveWorkbook.Worksheets(i).Cells(j, 1) Then
                
                rEnd = j
                OpenP = Worksheets(i).Cells(rstart, 3).Value
                CloseP = Worksheets(i).Cells(rEnd, 6).Value
                Temp = OpenP - CloseP
                ActiveWorkbook.Worksheets(i).Cells(2 + Count, 9) = Temp
                If Temp > 0 Then
                    ActiveWorkbook.Worksheets(i).Cells(2 + Count, 9).Interior.ColorIndex = 4
                Else
                    ActiveWorkbook.Worksheets(i).Cells(2 + Count, 9).Interior.ColorIndex = 3
                End If
                    
                If OpenP = 0 Then
                    GoTo NextIteration
                Else
                    ActiveWorkbook.Worksheets(i).Cells(2 + Count, 10) = (Temp / OpenP)
                End If
                
                str1 = "G" & rstart
                str2 = "G" & rEnd
                'MsgBox (str1)
                'MsgBox (str2)
                Vol = Application.WorksheetFunction.Sum((ActiveWorkbook.Worksheets(i).Range("str1:str2")))
                ActiveWorkbook.Worksheets(i).Cells(2 + Count, 11) = Vol
                
                
                ActiveWorkbook.Worksheets(i).Cells(2 + Count, 8) = ActiveWorkbook.Worksheets(i).Cells(j, 1)
                
                rstart = j + 1
                Count = Count + 1
NextIteration:
                
            End If
            
            
        
        Next j
    Next i
    

End Sub